# -*- coding: utf-8 -*-

import multiprocessing
import time


l = [['17605731289663' '629578710,629578720,500343710,500343690,629578730,629578740,3410250,3410631,3410601,629580900,629580910,880524120,3135820,629580941,629580931,3135831,90000252791320,90000252685920,90000242855550,90000242770110,629581090,3467170,3086091,3086071,3074111,3074121,3074130,3074141,3074150,3074161,877620980,877620990,90000245695000,90000245694960,323942860,323942870,323942720,323942730,629579671,629579661,880523071,849619761,849619591,849619691|629578710,629578720,500343710,500343690,629578730,629578740,3410250,3410631,3410601,629580900,629580910,880524120,3135820,629580961,629580951,880524051,3135791,629580580,629580600,629580530,629580720,629580730,3450800,3197440,3450780,3450790,90000284762970,90000284706200,193553020,193553030,3326860,3326870,3274070,3135960,3147710,629579671,629579661,880523071,849619761,849619591,849619691|629578710,629578720,500343710,500343690,629578730,629578740,3410250,3410631,3410601,629580900,629580910,880524120,3135820,629580941,629580931,3135831,90000252791320,90000252685920,90000242855550,90000242770110,629581090,90000242770190,90000242884470,90000242884430,3450770,3450740,629580430,90000243070070,90000242894630,172094510,500343670,90000245695000,90000245694960,323942860,323942870,323942720,323942730,629579671,629579661,880523071,849619761,849619591,849619691|629578710,629578720,500343710,500343690,629578730,629578740,3410250,3410631,3410601,629580900,629580910,880524120,3135820,629580961,629580951,880524051,3135791,90000242930071,90000242855471,500343551,416793671,629580271,629580261,629580331,629580321,90000245695000,90000245694960,323942860,323942870,323942720,323942730,629579671,629579661,880523071,849619761,849619591,849619691' '116.34269,39.82275' '116.32993,39.813661' '629578421,629578381,629578370,629578710,629578720,500343710,500343690,629578730,629578740,3410250,3410631,3410601,629580900,629580910,880524120,3135820,629580961,629580951,880524051,3135791,629580580,629580600,629580530,629580720,629580730,3450800,3197440,3450780,3450790,90000284762970,90000284706200,193553020,193553030,3326860,3326870,3274070,3135960,3147710,629579671,629579661,880523071,849619761,849619591,849619691']
 ,['17605731877372' '4973660,4973690,490656700,333277800,333277810,90000284842861,90000284684461,90000284897760,90000284772780,90000284907460,490656671,5098001,490656261,490656251,5113151,5113250,5113280,4607880,4607890,5038650,5038660,5097440,5097470,5085670,5085740,152545780,544630321,297742861,297742851,544630221,297742161,297742151,176100631,5129211,5129161,5129071,5129390,5129430,5038840,490655990,490656000,5098080,5098100,490656110,569397910,569397920,5144301,4419910,4631680,90000260614860,90000260717380,90000260615020,4953010,4953020,90000312885200,90000313010510,90000312950860,90000312950900,90000312885170,90000313010270,4464671,5135240,629830370,629830380,5135140,5135000,5135060,4411211,5134771|4973660,4973690,490656700,333277800,333277810,90000284842861,90000284684461,90000284897760,90000284772780,90000284907460,490656671,5098001,490656261,490656251,5113151,5113250,5113280,4607880,4607890,5038650,5038660,5097440,5097470,5085670,5085740,152545780,152545790,158120431,158120421,4607911,4419091,4419081,4545441,4433271,4433241,158120691,439208881,439208871,152545311,4604820,196950850,196950860,90000313046710,90000313046630,4464671,5135240,629830370,629830380,5135140,5135000,5135060,4411211,5134771|4973660,4973690,490656700,333277800,333277810,90000284842861,90000284684461,569397271,848843180,848843211,848843241,848843271,297742381,297742371,490656671,5098001,490656261,490656251,5113151,5113250,5113280,4607880,4607890,5038650,5038660,5097440,5097470,5085670,5085740,152545780,152545790,158120431,158120421,4607911,4419091,4419081,4545441,4433271,4433241,158120691,439208881,439208871,152545311,4604820,196950850,196950860,90000313046710,90000313046630,4464671,5135240,629830370,629830380,5135140,5135000,5135060,4411211,5134771|4973660,4973690,490656700,333277800,333277810,90000284842861,90000284684461,569397271,848843180,848843211,848843241,848843271,297742381,297742371,490656671,5098001,490656261,490656251,5113151,5113250,5113280,4607880,4607890,5038650,5038660,5097440,5097470,5085670,5085740,152545780,544630321,297742861,297742851,544630221,297742161,297742151,176100631,5129211,5129161,5129071,5129390,5129430,5038840,490655990,490656000,5098080,5098100,490656110,569397910,569397920,5144301,4419910,4631680,90000260614860,90000260717380,90000260615020,4953010,4953020,90000312885200,90000313010510,90000312950860,90000312950900,90000312885170,90000313010270,4464671,5135240,629830370,629830380,5135140,5135000,5135060,4411211,5134771' '116.32085,39.88936' '116.342543,39.902327' '4973660,4973690,490656700,333277800,333277810,90000284842861,90000284684461,90000284897760,90000284772780,90000284907460,490656671,5098001,878087730,878087740,5113250,5113280,4607880,4607890,5038650,5038660,5097440,5097470,5085670,5085740,152545780,152545790,4655640,4633250,158283890,158283900,490656540,5022701,5022691,5022681,4568631,5119271,5119231,4621131,5119461,5119431,5119551,4974781,4974741,5038391,90000256821631,90000256928551,415087681,5134381,90000256821951,90000256928631,629828661,629828660,90000256928630,90000256821950,5134601,5134561,4917781,622374921,622374911,4553691,4453541,132082151,132082141,4565411,4449681,622379061,622379051,4542531,415084151,415084141,415084131,415084121,4917601,4418670,158120860,158120870,402598111,402598101,4434151,4453560,4453570,4987921,4917801,158122111,158122101,4527601,700489141,700489131,4560501,4988110,4988130,5155450,4917840,333278300,333278310,4568740']
 ,['35188756674576' '415086751,415086741,416365281,416365271,712311360,415087940,618734810,618734820,90000237228970,90000237229150,90000237229130,416365420,618734830,618734850,618734860,416365440,416365451,416365521,416365511,4620160,4652140,4652160,4545621,5085481,5085471,126446970,126446980,5011540,5027150,5019390,5019410,878087890,878087900,4588580,5058621,5058611,4545480,5058660,5058670,499662440,499662460,499662470,5008130,4452530,4511230,4511240,4418870,4511250,4546330,878086800,878086810,4522321,4522291,90000252451680,90000252205420,499662370,90000252465540,90000252465500,622376550,622376560,5088910,5088920,4642290,4642300,204353480,402484570,402484580,4465460,4511320,4991300,6072721,329486471,329486461,6152381,6229451,5604021,5604011,5667111,5667081,6367541,6367531,5607511,5607491,495923831|415086751,415086741,416365281,416365271,712311360,415087940,618734810,618734820,90000237228970,90000237229150,90000237229130,416365420,618734830,618734850,618734860,416365440,416365451,416365521,416365511,4620160,4652140,4652160,4545621,5085481,5085471,126446970,126446980,5011540,5027150,5019390,5019410,878087890,878087900,4588580,5058621,5058611,4545480,5058660,5058670,499662440,499662460,499662470,5008130,4452530,4511230,4511240,5070370,5070380,706202990,706203000,4954820,4954840,4418860,4511200,196951290,196951300,90000255487900,90000255739700,90000255739580,433328030,4626580,4626590,5152660,90000255739420,90000255691060,4968770,128576670,128576680,4527641,4527631,433167901,433169311,433169301,433167870,433167880,433167860,878086630,4511270,4465460,4511320,4991300,6072721,329486471,329486461,6152381,6229451,5604021,5604011,5667111,5667081,6367541,6367531,5607511,5607491,495923831|415086751,415086741,416365281,416365271,712311360,415087940,618734810,618734820,90000237228970,90000237229150,90000237229130,416365420,618734830,618734850,618734860,416365440,416365451,416365521,416365511,415088050,415088031,4545621,5085481,5085471,126446970,126446980,5011540,5027150,5019390,5019410,878087890,878087900,4588580,5058621,5058611,4545480,5058660,5058670,499662440,499662460,499662470,5008130,4452530,4511230,4511240,5070370,5070380,706202990,706203000,4954820,4954840,4418860,4511200,196951290,196951300,90000255487900,90000255739700,90000255739580,433328030,4626580,4626590,5152660,90000255739420,90000255691060,4968770,128576670,128576680,4527641,4527631,433167901,433169311,433169301,433167870,433167880,433167860,878086630,4511270,4465460,4511320,4991300,6072721,329486471,329486461,6152381,6229451,5604021,5604011,5667111,5667081,6367541,6367531,5607511,5607491,495923831|415086751,415086741,416365281,416365271,712311360,415087940,618734810,618734820,90000237228970,90000237229150,90000237229130,416365420,618734830,618734850,618734860,416365440,416365451,416365521,416365511,4620160,4652140,4652160,4545621,5085481,5085471,126446970,126446980,5011540,5027150,5019390,5019410,878087890,878087900,5059051,5059011,146413021,146413011,4542441,4541971,4449461,4545810,880532480,178471700,90000252465540,90000252465500,622376550,622376560,5088910,5088920,4642290,4642300,204353480,402484570,402484580,4465460,4511320,4991300,6072721,329486471,329486461,6152381,6229451,5604021,5604011,5667111,5667081,6367541,6367531,5607511,5607491,495923831|415086751,415086741,416365281,416365271,712311360,415087940,618734810,618734820,90000237228970,90000237229150,90000237229130,416365420,618734830,618734850,618734860,416365440,416365451,416365521,416365511,415088050,415088031,4545621,5085481,5085471,126446970,126446980,5011540,5027150,5019390,5019410,878087890,878087900,4588580,5058621,5058611,4545480,5058660,5058670,499662440,499662460,499662470,5008130,4452530,4511230,4511240,4418870,4511250,4546330,878086800,878086810,4522321,4522291,90000252451680,90000252205420,499662370,90000252465540,90000252465500,622376550,622376560,5088910,5088920,4642290,4642300,204353480,402484570,402484580,4465460,4511320,4991300,6072721,329486471,329486461,6152381,6229451,5604021,5604011,5667111,5667081,6367541,6367531,5607511,5607491,495923831|415086751,415086741,416365281,416365271,712311360,415087940,618734810,618734820,90000237228970,90000237229150,90000237229130,416365420,618734830,618734850,618734860,618734790,90000311834680,90000311765840,297741400,297741410,152543000,152543010,878087921,878087911,5108491,5088421,4492361,5088261,5088411,5088401,4626371,4626351,5086201,4589230,5086210,4507070,622376910,622376920,4492491,4492471,4492431,4438491,4588800,4588810,90000312886930,90000312952440,4546160,4546190,5070360,5007940,5007960,5019420,5019450,4506990,5058621,5058611,4545480,5058660,5058670,499662440,499662460,499662470,5008130,4452530,4511230,4511240,4418870,4511250,4546330,878086800,878086810,4522321,4522291,90000252451680,90000252205420,499662370,90000252465540,90000252465500,622376550,622376560,5088910,5088920,4642290,4642300,204353480,402484570,402484580,4465460,4511320,4991300,6072721,329486471,329486461,6152381,6229451,5604021,5604011,5667111,5667081,6367541,6367531,5607511,5607491,495923831|415086751,415086741,416365281,416365271,712311360,415087940,618734810,618734820,90000237228970,90000237229150,90000237229130,416365420,618734830,618734850,618734860,416365440,416365451,416365521,416365511,415088050,415088031,4545621,5085481,5085471,126446970,126446980,5011540,5027150,5019390,5019410,878087890,878087900,5059051,5059011,146413021,146413011,4542441,4541971,4449461,4545810,880532480,178471700,90000252465540,90000252465500,622376550,622376560,5088910,5088920,4642290,4642300,204353480,402484570,402484580,4465460,4511320,4991300,6072721,329486471,329486461,6152381,6229451,5604021,5604011,5667111,5667081,6367541,6367531,5607511,5607491,495923831|415086751,415086741,416365281,416365271,712311360,415087940,618734810,618734820,90000237228970,90000237229150,90000237229130,416365420,618734830,618734850,618734860,416365440,416365451,416365521,416365511,4620160,4652140,4421820,128578160,128578170,128578140,90000208118920,90000208143190,4589330,4506641,4506621,4588810,90000312886930,90000312952440,4546160,4546190,5070360,5007940,5007960,5019420,5019450,4506990,5058621,5058611,4545480,5058660,5058670,499662440,499662460,499662470,5008130,4452530,4511230,4511240,4418870,4511250,4546330,878086800,878086810,4522321,4522291,90000252451680,90000252205420,499662370,90000252465540,90000252465500,622376550,622376560,5088910,5088920,4642290,4642300,204353480,402484570,402484580,4465460,4511320,4991300,6072721,329486471,329486461,6152381,6229451,5604021,5604011,5667111,5667081,6367541,6367531,5607511,5607491,495923831|415086751,415086741,416365281,416365271,712311360,415087940,618734810,618734820,90000237228970,90000237229150,90000237229130,416365420,618734830,618734850,618734860,416365440,416365451,416365521,416365511,415088050,415088031,4545621,5085481,5085471,126446970,126446980,5011540,5027150,5019390,5019410,878087890,878087900,5059051,5059011,146413021,146413011,4542441,4541971,4449461,4542411,878810581,878810571,849155891,849155881,6244511,6367311,5512341,5512311,610345071,610345061,6272851,299398270,299398280,6138191,622000320,433166630,433166640,433166700,433166710,433166680,438664050,438664060,196099500,196099510,6325290,6325370,6325390,90000288269850,90000288331810,6152360,6152330,5667111,5667081,6367541,6367531,5607511,5607491,495923831|415086751,415086741,416365281,416365271,712311360,415087940,618734810,618734820,90000237228970,90000237229150,90000237229130,416365420,618734830,618734850,618734860,416365440,416365451,416365521,416365511,4620160,4652140,4421820,128578160,128578170,128578140,90000208118920,90000208143190,4589330,4506641,4506621,4588810,90000312886930,90000312952440,4546160,4546190,5070360,5007940,5007960,5019420,5019450,4506990,5058621,5058611,4545480,5058660,5058670,499662440,499662460,499662470,5008130,4452530,4511230,4511240,5070370,5070380,706202990,706203000,4954820,4954840,4418860,4511200,196951290,196951300,90000255487900,90000255739700,90000255739580,433328030,4626580,4626590,5152660,90000255739420,90000255691060,4968770,128576670,128576680,4527641,4527631,433167901,433169311,433169301,433167870,433167880,433167860,878086630,4511270,4465460,4511320,4991300,6072721,329486471,329486461,6152381,6229451,5604021,5604011,5667111,5667081,6367541,6367531,5607511,5607491,495923831|415086751,415086741,416365281,416365271,712311360,415087940,618734810,618734820,90000237228970,90000237229150,90000237229130,416365420,618734830,618734850,618734860,618734790,90000311834680,90000311765840,297741400,297741410,152543000,152543010,878087921,878087911,5108491,5088421,4492361,5088261,5088411,5088401,4626371,4626351,5086201,4589230,5086210,4507070,622376910,622376920,4492491,4492471,4492431,4438491,4588800,4588810,90000312886930,90000312952440,4546160,4546190,5070360,5007940,5007960,5019420,5019450,4506990,5058621,5058611,4545480,5058660,5058670,499662440,499662460,499662470,5008130,4452530,4511230,4511240,5070370,5070380,706202990,706203000,4954820,4954840,4418860,4511200,196951290,196951300,90000255487900,90000255739700,90000255739580,433328030,4626580,4626590,5152660,90000255739420,90000255691060,4968770,128576670,128576680,4527641,4527631,433167901,433169311,433169301,433167870,433167880,433167860,878086630,4511270,4465460,4511320,4991300,6072721,329486471,329486461,6152381,6229451,5604021,5604011,5667111,5667081,6367541,6367531,5607511,5607491,495923831|415086751,415086741,416365281,416365271,712311360,415087940,618734810,618734820,90000237228970,90000237229150,90000237229130,416365420,618734830,618734850,618734860,416365440,416365451,416365521,416365511,4620160,4652140,4652160,4545621,5085481,5085471,126446970,126446980,5011540,5027150,5019390,5019410,878087890,878087900,5059051,5059011,146413021,146413011,4542441,4541971,4449461,4542411,878810581,878810571,849155891,849155881,6244511,6367311,5512341,5512311,610345071,610345061,6272851,299398270,299398280,6138191,622000320,433166630,433166640,433166700,433166710,433166680,438664050,438664060,196099500,196099510,6325290,6325370,6325390,90000288269850,90000288331810,6152360,6152330,5667111,5667081,6367541,6367531,5607511,5607491,495923831' '116.324048,39.860673' '116.37901,39.86499' '415086751,415086741,416365281,416365271,712311360,415087940,618734810,618734820,90000237228970,90000237229150,90000237229130,416365420,618734830,618734850,618734860,416365440,416365451,416365521,416365511,415088050,415088031,4545621,5085481,5085471,126446970,126446980,5011540,5027150,5019390,5019470,5019450,4506990,5058621,5058611,4545480,5058660,5058670,499662440,499662460,499662470,5008130,4452530,4511230,4511240,5070370,5070380,706202990,706203000,4954820,4954840,5088660,5088670,5088610,5088620,4418880,4511191,196951281,196951271,90000310926531,90000310987751,433170291,433170281,4626611,4453261,90000259627461,90000259445021,4467980,415086700,415086710,4511280,5088760,5088770,4411930,4411780,5055320,499662390,499662400,6367601,5607601,5607571,490654220,490654230,6150010,6305840,6150020,6138221,6367561']
 ,['17605733744368' '4980811,4980801,4435101,4435071,4434691,4434681,4980820,4980830,4454190,4498930,4448710,4448720,5006980,4620270,5085630,5085640,4994420,4994450,4472440,4435660,4435670,4639310,4639320,4526591,622697911,622697901,700489021,402479040,622698020,622698030,402479060,402479070,4655101,4655091,4418510,4655111,5025771,300758991,300758981,4655151,5025681,5025671,4655161,196951330,90000288021330,90000288021290' '116.34751,39.8894' '116.36789,39.88846' '4980811,4980801,4435101,4435071,4434691,4434681,4980820,4980830,4454190,4498930,4448710,4448720,5006980,4620270,5085630,5085640,4994420,4994450,4472440,4435660,4435670,4639310,4639320,4526591,622697911,622697901,700489021,402479040,622698020,622698030,402479060,402479070,4655101,4655091,4418510,4655111,5025771,300758991,300758981,4655151,5025681,5025671,4655161,196951330,90000288021330,90000288228111,90000289345321,90000289565171']]


print(l)


def parse_line(text):
    print(text)
    col1, restore_routes, col3, col4, col5 = text.split(" ")
    # restore_list = restore_routes.split("|")
    # start_coord_x, start_coord_y = col3.split(",")
    # end_coord_x, end_coord_y = col4.split(",")
    # return col1, restore_list, start_coord_x, start_coord_y, end_coord_x, end_coord_y, col5


def multiprocessing_test():

    # get all worker process

    cores = multiprocessing.cpu_count()

    print("cores=", cores)

    # start all worker process

    pool = multiprocessing.Pool(processes=cores)

    task = [x for x in l]
    start_time = time.time()
    # for i in range(100000):
    for i in range(1):
        print(pool.starmap(parse_line, task))
        # pool.starmap(parse_line, l)

    end_time = time.time()

    print("COST=", end_time - start_time)

    """
    COST= 56.09570097923279
    """



#
# def add(x, y):
#     return x + y
#
#
# def multiprocessing_test():
#
#     # get all worker process
#
#     cores = multiprocessing.cpu_count()
#
#     print("cores=", cores)
#
#     # start all worker process
#
#     pool = multiprocessing.Pool(processes=cores)
#
#     x1 = list(range(5))
#     y1 = list(range(5))
#
#     tasks = [(x, y) for x in x1 for y in y1]
#     print(tasks)
#     start_time = time.time()
#     # for i in range(100000):
#     for i in range(10000):
#         # print(pool.starmap(add, tasks))
#         pool.starmap(add, tasks)
#
#     end_time = time.time()
#
#     print("COST=", end_time - start_time)
#
#     """
#     COST= 56.09570097923279
#     """
#
#
# def simple_loop():
#     x1 = list(range(5))
#     y1 = list(range(5))
#
#     start_time = time.time()
#
#     tasks = [(x, y) for x in x1 for y in y1]
#     print(tasks)
#     for i in range(10000):
#         for (x, y) in tasks:
#             z = x + y
#             # print(z)
#
#     end_time = time.time()
#
#     print("COST=", end_time - start_time)
#
if __name__ == "__main__":
    multiprocessing_test()
    # simple_loop()
